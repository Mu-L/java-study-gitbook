(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{541:function(t,s,a){"use strict";a.r(s);var n=a(26),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"oracle在1对多时把一列的值合并为一个值并用逗号分隔"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#oracle在1对多时把一列的值合并为一个值并用逗号分隔"}},[t._v("#")]),t._v(" Oracle在1对多时把一列的值合并为一个值并用逗号分隔")]),t._v(" "),a("p",[t._v("Oracle把一列的值合并为一个值，并用逗号分隔。")]),t._v(" "),a("p",[t._v("实例中将把部门表（DEPT表）与员工表（EMP表）关联，查询每个部门下的所有员工姓名，员工姓名之间以逗号分隔（如图一）。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/img/image-20201221152131891.png",alt:"image-20201221152131891"}})]),t._v(" "),a("h2",{attrs:{id:"_1-wmsys-wm-concat-列名-函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-wmsys-wm-concat-列名-函数"}},[t._v("#")]),t._v(" 1. WMSYS.WM_CONCAT(列名)函数")]),t._v(" "),a("p",[t._v("介绍：其函数在Oracle 10g推出，在10g版本中，返回字符串类型，在11g版本中返回clob类型。括号里面的参数是列，而且可以是多个列的集合，也就是说在括号里面可以自由地用‘||’合并字符串。")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" 部门编号"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DNAME "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" 部门名称"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WMSYS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WM_CONCAT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ENAME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" 员工列表 \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" DEPT D\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" EMP E "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DNAME\n")])])]),a("p",[t._v("拼接多列（拼接员工姓名和员工编号）")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" 部门编号"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DNAME "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" 部门名称"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("WMSYS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("WM_CONCAT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ENAME"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'('")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v("E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EMPNO"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("')'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" 员工列表 \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" DEPT D\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" EMP E "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DNAME\n")])])]),a("h2",{attrs:{id:"_2-listagg-列名-分隔符-within-group-order-by-列名-函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-listagg-列名-分隔符-within-group-order-by-列名-函数"}},[t._v("#")]),t._v(" 2. LISTAGG(列名,<分隔符>) WITHIN GROUP(ORDER BY 列名)函数")]),t._v(" "),a("p",[t._v("介绍：其函数在Oracle 11g 版本中推出，对分组后的数据按照一定的排序进行字符串连接。")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" 部门编号"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DNAME "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" 部门名称"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("LISTAGG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ENAME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("','")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITHIN")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ENAME"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" 员工列表 \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" DEPT D\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" EMP E "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" E"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DEPTNO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DNAME\n")])])]),a("p",[t._v("LISTAGG 中的字段可以不写在GROUP BY")]),t._v(" "),a("h2",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/pan_junbiao/article/details/79948222",target:"_blank",rel:"noopener noreferrer"}},[t._v("Oracle把一列的值合并为一个值并用逗号分隔"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);