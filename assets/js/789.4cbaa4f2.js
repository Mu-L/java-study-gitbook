(window.webpackJsonp=window.webpackJsonp||[]).push([[789],{1168:function(e,t,s){"use strict";s.r(t);var a=s(26),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"selenium入门"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#selenium入门"}},[e._v("#")]),e._v(" Selenium入门")]),e._v(" "),s("h2",{attrs:{id:"_1-简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-简介"}},[e._v("#")]),e._v(" 1. 简介")]),e._v(" "),s("p",[e._v("Selenium是 自动化测试工具。它支持各种浏览器，包括 Chrome，Safari，Firefox 等主流界面式浏览器。主要用电脑模拟人操作浏览器网页，可以实现自动化，测试等")]),e._v(" "),s("h2",{attrs:{id:"_2-初步体验"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-初步体验"}},[e._v("#")]),e._v(" 2. 初步体验")]),e._v(" "),s("blockquote",[s("p",[e._v("忽略安装Selenium 和 浏览器驱动安装和配置，如有需求自行百度")])]),e._v(" "),s("p",[e._v("运行如下代码，会自动打开浏览器，然后访问百度。")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("from selenium import webdriver\n\nbrowser = webdriver.Chrome()\n# browser = webdriver.Chrome(r\"C:\\Users\\Administrator\\Downloads\\chromedriver_win32\\chromedriver.exe\")\nbrowser.get('http://www.baidu.com/')\n")])])]),s("p",[s("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/img/image-20210204133157683.png",alt:"image-20210204133157683"}})]),e._v(" "),s("h2",{attrs:{id:"_3-模拟提交"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-模拟提交"}},[e._v("#")]),e._v(" 3. 模拟提交")]),e._v(" "),s("p",[e._v("下面的代码实现模拟提交搜索功能，首先等页面加载完成，然后输入到搜索框文本，点击提交。")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('from selenium import webdriver\nfrom selenium.webdriver.common.keys import Keys\n\n# driver = webdriver.Firefox()\ndriver = webdriver.Chrome(r"C:\\Users\\Administrator\\Downloads\\chromedriver_win32\\chromedriver.exe")\ndriver.get("http://www.python.org")\nassert "Python" in driver.title\nelem = driver.find_element_by_name("q")\nelem.clear()\nelem.send_keys("pycon")\nelem.send_keys(Keys.RETURN)\nassert "No results found." not in driver.page_source\ndriver.close()\n')])])]),s("ul",[s("li",[s("p",[e._v("其中 driver.get 方法会打开请求的 URL，WebDriver 会等待页面完全加载完成之后才会返回，即程序会等待页面的所有内容加载完成，JS 渲染完毕之后才继续往下执行。注意：如果这里用到了特别多的 Ajax 的话，程序可能不知道是否已经完全加载完毕。")]),e._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[e._v("driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"http://www.python.org"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])])]),e._v(" "),s("li",[s("p",[e._v("WebDriver 提供了大量的方法让你去查询页面中的元素，这些方法形如： find_element_by_*。 例如：包含 name 属性的input输入框可以通过 find_element_by_name 方法查找到， 详细的查找方法可以在第四节元素查找中查看")]),e._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[e._v("elem "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("find_element_by_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"q"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])])]),e._v(" "),s("li",[s("p",[e._v("我们发送了一个关键字，这个方法的作用类似于你用键盘输入关键字")]),e._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[e._v("elem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("clear"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\nelem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("send_keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"pycon"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\nelem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("send_keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("Keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("RETURN"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])])])]),e._v(" "),s("h2",{attrs:{id:"_4-元素定位"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-元素定位"}},[e._v("#")]),e._v(" 4. 元素定位")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("find_element_by_id()\nfind_element_by_name()\nfind_element_by_class_name()\nfind_element_by_tag_name()\nfind_element_by_link_text()\nfind_element_by_partial_link_text()\nfind_element_by_xpath()\nfind_element_by_css_selector()\n")])])]),s("p",[e._v("在"),s("code",[e._v("element")]),e._v("变成"),s("code",[e._v("elements")]),e._v("就是找所有满足的条件，返回数组。")]),e._v(" "),s("p",[e._v("一般我都自己采用 "),s("strong",[e._v("xpath")]),e._v(" 获取元素的，复制即可")]),e._v(" "),s("p",[s("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/img/image-20210204134742935.png",alt:"image-20210204134742935"}})]),e._v(" "),s("h2",{attrs:{id:"_5-控制浏览器操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-控制浏览器操作"}},[e._v("#")]),e._v(" 5. 控制浏览器操作")]),e._v(" "),s("ul",[s("li",[e._v("控制浏览器窗口大小")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("driver.set_window_size(480, 800)\n")])])]),s("ul",[s("li",[e._v("浏览器后退，前进")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("# 后退 driver.back()\n# 前进 driver.forward()\n")])])]),s("ul",[s("li",[e._v("刷新")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("driver.refresh() # 刷新\n")])])]),s("h2",{attrs:{id:"_6-webelement常用方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-webelement常用方法"}},[e._v("#")]),e._v(" 6. Webelement常用方法")]),e._v(" "),s("ul",[s("li",[e._v("点击和输入")])]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('driver.find_element_by_id("kw").clear() # 清除文本 driver.find_element_by_id("kw").send_keys("selenium") # 模拟按键输入 driver.find_element_by_id("su").click() # 单机元素\n')])])]),s("ul",[s("li",[e._v("提交")])]),e._v(" "),s("p",[e._v("可以在搜索框模拟回车操作")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("search_text = driver.find_element_by_id('kw') search_text.send_keys('selenium') search_text.submit()\n")])])]),s("ul",[s("li",[e._v("其他")])]),e._v(" "),s("p",[e._v("size： 返回元素的尺寸。")]),e._v(" "),s("p",[e._v("text： 获取元素的文本。")]),e._v(" "),s("p",[e._v("get_attribute(name)： 获得属性值。")]),e._v(" "),s("p",[e._v("is_displayed()： 设置该元素是否用户可见。")]),e._v(" "),s("h2",{attrs:{id:"_7-鼠标操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-鼠标操作"}},[e._v("#")]),e._v(" 7. 鼠标操作")]),e._v(" "),s("p",[e._v("在 WebDriver 中， 将这些关于鼠标操作的方法封装在 ActionChains 类提供。")]),e._v(" "),s("p",[e._v("ActionChains 类提供了鼠标操作的常用方法：")]),e._v(" "),s("ul",[s("li",[e._v("perform()： 执行所有 ActionChains 中存储的行为；")]),e._v(" "),s("li",[e._v("context_click()： 右击；")]),e._v(" "),s("li",[e._v("double_click()： 双击；")]),e._v(" "),s("li",[e._v("drag_and_drop()： 拖动；")]),e._v(" "),s("li",[e._v("move_to_element()： 鼠标悬停。")])]),e._v(" "),s("p",[e._v("举个例子：")]),e._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" selenium "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" webdriver\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 引入 ActionChains 类")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" selenium"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("common"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("action_chains "),s("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" ActionChains\n\ndriver "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" webdriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Chrome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\ndriver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("get"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://www.baidu.cn"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 定位到要悬停的元素")]),e._v("\nabove "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("find_element_by_link_text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"设置"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 对定位到的元素执行鼠标悬停操作")]),e._v("\nActionChains"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("driver"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("move_to_element"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("above"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("perform"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),s("h2",{attrs:{id:"_8-键盘事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-键盘事件"}},[e._v("#")]),e._v(" 8. 键盘事件")]),e._v(" "),s("p",[e._v("以下为常用的键盘操作：")]),e._v(" "),s("ul",[s("li",[e._v("send_keys(Keys.BACK_SPACE) 删除键（BackSpace）")]),e._v(" "),s("li",[e._v("send_keys(Keys.SPACE) 空格键(Space)")]),e._v(" "),s("li",[e._v("send_keys(Keys.TAB) 制表键(Tab)")]),e._v(" "),s("li",[e._v("send_keys(Keys.ESCAPE) 回退键（Esc）")]),e._v(" "),s("li",[e._v("send_keys(Keys.ENTER) 回车键（Enter）")]),e._v(" "),s("li",[e._v("send_keys(Keys.CONTROL,'a') 全选（Ctrl+A）")]),e._v(" "),s("li",[e._v("send_keys(Keys.CONTROL,'c') 复制（Ctrl+C）")]),e._v(" "),s("li",[e._v("send_keys(Keys.CONTROL,'x') 剪切（Ctrl+X）")]),e._v(" "),s("li",[e._v("send_keys(Keys.CONTROL,'v') 粘贴（Ctrl+V）")]),e._v(" "),s("li",[e._v("send_keys(Keys.F1) 键盘 F1")]),e._v(" "),s("li",[e._v("……")]),e._v(" "),s("li",[e._v("send_keys(Keys.F12) 键盘 F12")])]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('# 输入框输入内容\ndriver.find_element_by_id("kw").send_keys("seleniumm")\n\n# 删除多输入的一个 m\ndriver.find_element_by_id("kw").send_keys(Keys.BACK_SPACE)\n')])])]),s("h2",{attrs:{id:"_9-警告框处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-警告框处理"}},[e._v("#")]),e._v(" 9. 警告框处理")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("alert = driver.switch_to_alert()\n")])])]),s("ul",[s("li",[e._v("text：返回 alert/confirm/prompt 中的文字信息。")]),e._v(" "),s("li",[e._v("accept()：接受现有警告框。")]),e._v(" "),s("li",[e._v("dismiss()：解散现有警告框。")]),e._v(" "),s("li",[e._v("send_keys(keysToSend)：发送文本至警告框。keysToSend：将文本发送至警告框。")])]),e._v(" "),s("h2",{attrs:{id:"_10-下拉框选择"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_10-下拉框选择"}},[e._v("#")]),e._v(" 10. 下拉框选择")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("from selenium import webdriver\nfrom selenium.webdriver.support.select import Select\nfrom time import sleep\n\ndriver = webdriver.Chrome()\ndriver.implicitly_wait(10)\ndriver.get('http://www.baidu.com')\nsel = driver.find_element_by_xpath(\"//select[@id='nr']\")\nSelect(sel).select_by_value('50')  # 显示50条\n")])])]),s("h2",{attrs:{id:"_11-文件上传"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_11-文件上传"}},[e._v("#")]),e._v(" 11. 文件上传")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("driver.find_element_by_name(\"file\").send_keys('D:\\\\upload_file.txt')  # # 定位上传按钮，添加本地文件\n")])])]),s("h2",{attrs:{id:"_12-cookie操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_12-cookie操作"}},[e._v("#")]),e._v(" 12. cookie操作")]),e._v(" "),s("p",[e._v("WebDriver操作cookie的方法：")]),e._v(" "),s("ul",[s("li",[e._v("get_cookies()： 获得所有cookie信息。")]),e._v(" "),s("li",[e._v("get_cookie(name)： 返回字典的key为“name”的cookie信息。")]),e._v(" "),s("li",[e._v("add_cookie(cookie_dict) ： 添加cookie。“cookie_dict”指字典对象，必须有name 和value 值。")]),e._v(" "),s("li",[e._v("delete_cookie(name,optionsString)：删除cookie信息。“name”是要删除的cookie的名称，“optionsString”是该cookie的选项，目前支持的选项包括“路径”，“域”。")]),e._v(" "),s("li",[e._v("delete_all_cookies()： 删除所有cookie信息")])]),e._v(" "),s("h2",{attrs:{id:"_13-调用javascript代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_13-调用javascript代码"}},[e._v("#")]),e._v(" 13. 调用JavaScript代码")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('js="window.scrollTo(100,450);"\ndriver.execute_script(js) # 通过javascript设置浏览器窗口的滚动条位置\n')])])]),s("p",[e._v("通过execute_script()方法执行JavaScripts代码来移动滚动条的位置。")]),e._v(" "),s("h2",{attrs:{id:"_14-窗口截图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_14-窗口截图"}},[e._v("#")]),e._v(" 14. 窗口截图")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('driver.get_screenshot_as_file("D:\\\\baidu_img.jpg") # 截取当前窗口，并指定截图图片的保存位置\n')])])]),s("h2",{attrs:{id:"_15-关闭浏览器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_15-关闭浏览器"}},[e._v("#")]),e._v(" 15. 关闭浏览器")]),e._v(" "),s("ul",[s("li",[e._v("close() 关闭单个窗口")]),e._v(" "),s("li",[e._v("quit() 关闭所有窗口")])]),e._v(" "),s("h2",{attrs:{id:"参考文章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[e._v("#")]),e._v(" 参考文章")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/111859925",target:"_blank",rel:"noopener noreferrer"}},[e._v("Selenium Python 教程"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"https://selenium-python-zh.readthedocs.io/en/latest/locating-elements.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("selenium官方文档"),s("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=r.exports}}]);