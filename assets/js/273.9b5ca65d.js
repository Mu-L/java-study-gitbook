(window.webpackJsonp=window.webpackJsonp||[]).push([[273],{650:function(t,s,a){"use strict";a.r(s);var n=a(26),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"mysql-触发器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql-触发器"}},[t._v("#")]),t._v(" MySQL-触发器")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 触发器 */")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("------------------")]),t._v("\n    触发程序是与表有关的命名数据库对象，当该表出现特定事件时，将激活该对象\n    监听：记录的增加、修改、删除。\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 创建触发器")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRIGGER")]),t._v(" trigger_name trigger_time trigger_event "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" tbl_name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FOR EACH ROW")]),t._v(" trigger_stmt\n    参数：\n    trigger_time是触发程序的动作时间。它可以是 before 或 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("after")]),t._v("，以指明触发程序是在激活它的语句之前或之后触发。\n    trigger_event指明了激活触发程序的语句的类型\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v("：将新行插入表时激活触发程序\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UPDATE")]),t._v("：更改某一行时激活触发程序\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DELETE")]),t._v("：从表中删除某一行时激活触发程序\n    tbl_name：监听的表，必须是永久性的表，不能将触发程序与"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TEMPORARY")]),t._v("表或视图关联起来。\n    trigger_stmt：当触发程序激活时执行的语句。执行多个语句，可使用"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BEGIN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("END")]),t._v("复合语句结构\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 删除")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TRIGGER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("schema_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("trigger_name\n可以使用old和new代替旧的和新的数据\n    更新操作，更新前是old，更新后是new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    删除操作，只有old"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n    增加操作，只有new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 注意")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v(" 对于具有相同触发程序动作时间和事件的给定表，不能有两个触发程序。\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 字符连接函数")]),t._v("\nconcat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("str2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconcat_ws"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("separator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("str1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("str2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 分支语句")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" 条件 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    执行语句\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("elseif")]),t._v(" 条件 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    执行语句\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    执行语句\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 修改最外层语句结束符")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delimiter")]),t._v(" 自定义结束符号\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SQL")]),t._v("语句\n自定义结束符号\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delimiter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 修改回原来的分号")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 语句块包裹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n    语句块\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- 特殊的执行")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),t._v(" 只要添加记录，就会触发程序。\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Insert")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("into")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("duplicate")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("key")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("update")]),t._v(" 语法会触发：\n    如果没有重复记录，会触发 before "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("after")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    如果有重复记录并更新，会触发 before "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" before "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("after")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    如果有重复记录但是没有发生更新，则触发 before "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" before "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("update")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Replace")]),t._v(" 语法 如果有记录，则执行 before "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" before "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("after")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("after")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("insert")]),t._v("\n")])])]),a("h2",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://javaguide.cn/database/mysql/a-thousand-lines-of-mysql-study-notes/#",target:"_blank",rel:"noopener noreferrer"}},[t._v("一千行 MySQL 学习笔记"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);