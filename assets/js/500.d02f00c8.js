(window.webpackJsonp=window.webpackJsonp||[]).push([[500],{879:function(t,a,s){"use strict";s.r(a);var e=s(26),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"docker基础-仓库-镜像-容器详解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker基础-仓库-镜像-容器详解"}},[t._v("#")]),t._v(" Docker基础-仓库，镜像，容器详解")]),t._v(" "),s("h2",{attrs:{id:"_1-仓库-镜像-容器的关系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-仓库-镜像-容器的关系"}},[t._v("#")]),t._v(" 1. 仓库，镜像，容器的关系")]),t._v(" "),s("blockquote",[s("p",[t._v("我们再回顾下仓库，镜像，容器的关系（这是官网的图）")])]),t._v(" "),s("p",[t._v("通过下图可以得知，"),s("code",[t._v("Docker")]),t._v("在运行时分为"),s("code",[t._v("Docker引擎（服务端守护进程）")]),t._v("和"),s("code",[t._v("客户端工具")]),t._v("，我们日常使用各种"),s("code",[t._v("docker命令")]),t._v("，其实就是在使用"),s("code",[t._v("客户端工具")]),t._v("与"),s("code",[t._v("Docker")]),t._v("引擎进行交互。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220613201437616.png",alt:"image-20220613201437616"}})]),t._v(" "),s("h2",{attrs:{id:"_2-docker-镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-docker-镜像"}},[t._v("#")]),t._v(" 2. Docker 镜像")]),t._v(" "),s("p",[t._v("当运行容器时，使用的镜像如果在本地中不存在，docker 就会自动从 docker 镜像仓库中下载，默认是从 Docker Hub 公共镜像源下载。")]),t._v(" "),s("p",[t._v("下面我们来学 1、管理和使用本地 Docker 主机镜像 2、创建镜像")]),t._v(" "),s("h3",{attrs:{id:"_2-1-镜像列表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-镜像列表"}},[t._v("#")]),t._v(" 2.1 镜像列表")]),t._v(" "),s("p",[t._v("我们可以使用 docker images 来列出本地主机上的镜像")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZwz914d1peizv4h7laju4Z ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker images")]),t._v("\nREPOSITORY        TAG            IMAGE ID       CREATED        SIZE\nminio/minio       latest         1afc478341fd   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" months ago   254MB\nrabbitmq          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("-management   3e83da0dc938   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(" months ago   253MB\nmongo             latest         0bcbeb494bed   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(" months ago   684MB\n\n")])])]),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("REPOSITORY")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("镜像在仓库中的名称")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("TAG")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("镜像标签")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("IMAGE ID")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("镜像 ID")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("CREATED")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("镜像的创建日期")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("SIZE")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("镜像大小")])])])]),t._v(" "),s("p",[t._v("这些镜像都是存储在"),s("code",[t._v("Docker")]),t._v("宿主机的"),s("code",[t._v("/var/lib/docker")]),t._v("目录下")]),t._v(" "),s("h3",{attrs:{id:"_2-2-查找镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-查找镜像"}},[t._v("#")]),t._v(" 2.2 查找镜像")]),t._v(" "),s("blockquote",[s("p",[t._v("以查找MySQL的镜像为例：")])]),t._v(" "),s("ul",[s("li",[t._v("方式一："),s("strong",[t._v("通过Docker Hub 进行查找")]),t._v(", 比如"),s("a",{attrs:{href:"https://hub.docker.com/search?q=mysql&type=image",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://hub.docker.com/search?q=mysql&type=image  (opens new window)"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220613202907992.png",alt:"image-20220613202907992"}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("方式二："),s("strong",[t._v("使用 docker search 命令来搜索镜像")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps")]),t._v("\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker search mysql")]),t._v("\nNAME                              DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED\nmysql                             MySQL is a widely used, open-source relation…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9132")]),t._v("                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nmariadb                           MariaDB is a community-developed fork of MyS…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3233")]),t._v("                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nmysql/mysql-server                Optimized MySQL Server Docker images. Create…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("676")]),t._v("                                     "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ncentos/mysql-57-centos7           MySQL "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.7")]),t._v(" SQL database server                   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("68")]),t._v("\nmysql/mysql-cluster               Experimental MySQL Cluster Docker images. Cr…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("62")]),t._v("\ncenturylink/mysql                 Image containing mysql. Optimized to be link…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("61")]),t._v("                                      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndeitch/mysql-backup               REPLACED"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" Please use http://hub.docker.com/r…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("41")]),t._v("                                      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nbitnami/mysql                     Bitnami MySQL Docker Image                      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35")]),t._v("                                      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ntutum/mysql                       Base docker image to run a MySQL database se…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("34")]),t._v("\nschickling/mysql-backup-s3        Backup MySQL to S3 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("supports periodic backup…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("29")]),t._v("                                      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nprom/mysqld-exporter                                                              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v("                                      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nlinuxserver/mysql                 A Mysql container, brought to you by LinuxSe…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v("\ncentos/mysql-56-centos7           MySQL "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.6")]),t._v(" SQL database server                   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v("\ncircleci/mysql                    MySQL is a widely used, open-source relation…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v("\nmysql/mysql-router                MySQL Router provides transparent routing be…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v("\narey/mysql-client                 Run a MySQL client from a docker container      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v("                                      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndataback/mysql-backup             Back up mysql databases to"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". anywhere"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\nopenshift/mysql-55-centos7        DEPRECATED: A Centos7 based MySQL v5.5 image…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("\nfradelg/mysql-cron-backup         MySQL/MariaDB database backup using "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cron")]),t._v(" tas…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("                                       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ngenschsa/mysql-employees          MySQL Employee Sample Database                  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("                                       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndevilbox/mysql                    Retagged MySQL, MariaDB and PerconaDB offici…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nansibleplaybookbundle/mysql-apb   An APB "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" deploys RHSCL MySQL                "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("                                       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\njelastic/mysql                    An image of the MySQL database server mainta…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nmonasca/mysql-init                A minimal decoupled init container "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" mysql    "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nwiddpim/mysql-client              Dockerized MySQL Client "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" including Curl…   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("                                       "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n\n")])])])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("属性")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("NAME")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("镜像名称")])]),t._v(" "),s("tr",[s("td",[t._v("DESCRIPTION")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("镜像描述")])]),t._v(" "),s("tr",[s("td",[t._v("STARS")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("用户评价")])]),t._v(" "),s("tr",[s("td",[t._v("OFFICIAL")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("是否为官方构建")])]),t._v(" "),s("tr",[s("td",[t._v("AUTOMATED")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Docker Hub 自动构建")])])])]),t._v(" "),s("h3",{attrs:{id:"_2-3-拉取镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-拉取镜像"}},[t._v("#")]),t._v(" 2.3 拉取镜像")]),t._v(" "),s("p",[t._v("拉取镜像就是从中央仓库下载镜像到本地。")]),t._v(" "),s("p",[t._v("执行命令："),s("code",[t._v("docker pull 镜像名称")])]),t._v(" "),s("p",[t._v("如果不声明"),s("code",[t._v("tag")]),t._v("镜像标签信息则默认拉取"),s("code",[t._v("latest")]),t._v("版本。")]),t._v(" "),s("blockquote",[s("p",[t._v("现在拉取搜索出的MySQL")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\n[root@ ~]# docker pull mysql\nUsing default tag: latest\nlatest: Pulling from library/mysql\n619014d83c02: Pull complete\n9ced578c3a5f: Pull complete\n731f6e13d8ea: Pull complete\n3c183de42679: Pull complete\n6de69b5c2f3c: Pull complete\n00f0a4086406: Pull complete\n84d93aea836d: Pull complete\nf18efbfd8d76: Pull complete\n012b302865d1: Pull complete\nfe16fd240f59: Pull complete\nca3e793e545e: Pull complete\n51d0f2cb2610: Pull complete\nDigest: sha256:6d0741319b6a2ae22c384a97f4bbee411b01e75f6284af0cce339fee83d7e314\nStatus: Downloaded newer image for mysql:latest\ndocker.io/library/mysql:latest\n[root@pdai ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nmysql               latest              791b6e40940c        2 weeks ago         465MB\nubuntu              latest              ccc6e87d482b        4 weeks ago         64.2MB\nhello-world         latest              fce289e99eb9        13 months ago       1.84kB\n  \n")])])]),s("h3",{attrs:{id:"_2-4-删除镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-删除镜像"}},[t._v("#")]),t._v(" 2.4 删除镜像")]),t._v(" "),s("p",[t._v("按镜像"),s("code",[t._v("ID")]),t._v("删除单个镜像。")]),t._v(" "),s("p",[t._v("执行命令："),s("code",[t._v("docker rmi 镜像ID")])]),t._v(" "),s("p",[t._v("按镜像"),s("code",[t._v("ID")]),t._v("删除多个镜像。")]),t._v(" "),s("p",[t._v("执行命令："),s("code",[t._v("docker rmi 镜像ID 镜像ID 镜像ID")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker rmi hello-world")]),t._v("\nError response from daemon: conflict: unable to remove repository reference "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello-world"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("must force"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" - container c91b90b18884 is using its referenced image fce289e99eb9\n")])])]),s("p",[s("code",[t._v("docker images -q")]),t._v("可以查询到所有镜像的"),s("code",[t._v("ID")]),t._v("，通过组合命令可以实现删除所有镜像的操作。")]),t._v(" "),s("p",[t._v("执行命令："),s("code",[t._v("docker rmi docker images -q")])]),t._v(" "),s("p",[t._v("发现报错了，这时候主要看两点：")]),t._v(" "),s("ul",[s("li",[t._v("要么就是container实例存在")]),t._v(" "),s("li",[t._v("要么存在镜像依赖；")])]),t._v(" "),s("h3",{attrs:{id:"_2-5-更新镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-更新镜像"}},[t._v("#")]),t._v(" 2.5 更新镜像")]),t._v(" "),s("blockquote",[s("p",[t._v("针对上述ubuntu的镜像，我们能否在里面安装一些软件，然后重新生成一个镜像呢？这就是更新重新commit出一个新的镜像。")])]),t._v(" "),s("p",[t._v("我们先跑一个ubuntu容器实例，同时在里面进行"),s("code",[t._v("apt-get update")]),t._v("更新")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -it ubuntu:latest")]),t._v("\nroot@0a1556ca3c27:/"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# apt-get update")]),t._v("\nGet:1 http://security.ubuntu.com/ubuntu bionic-security InRelease "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("88.7")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:2 http://archive.ubuntu.com/ubuntu bionic InRelease "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("242")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:3 http://archive.ubuntu.com/ubuntu bionic-updates InRelease "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("88.7")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:4 http://archive.ubuntu.com/ubuntu bionic-backports InRelease "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("74.6")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:5 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("817")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:6 http://archive.ubuntu.com/ubuntu bionic/main amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1344")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:7 http://archive.ubuntu.com/ubuntu bionic/multiverse amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("186")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:8 http://archive.ubuntu.com/ubuntu bionic/restricted amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13.5")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:9 http://archive.ubuntu.com/ubuntu bionic/universe amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.3")]),t._v(" MB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:10 http://security.ubuntu.com/ubuntu bionic-security/restricted amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("27.5")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:11 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7064")]),t._v(" B"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:12 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("818")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:13 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.1")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:14 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1345")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:15 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("41.2")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:16 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1104")]),t._v(" kB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:17 http://archive.ubuntu.com/ubuntu bionic-backports/universe amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4252")]),t._v(" B"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:18 http://archive.ubuntu.com/ubuntu bionic-backports/main amd64 Packages "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2496")]),t._v(" B"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nFetched "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17.6")]),t._v(" MB "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" 10s "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1759")]),t._v(" kB/s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nReading package lists"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". Done\nroot@0a1556ca3c27:/"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# exit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n\n")])])]),s("p",[t._v("此时 ID 为 0a1556ca3c27 的容器，是按我们的需求更改的容器。我们可以通过命令 docker commit 来提交容器副本：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# docker commit -m="update test" -a="pdai" 0a1556ca3c27  pdai/ubuntu:v1.0.1')]),t._v("\nsha256:b51e9f5f98cdb5b95c34181148ed7029f0150618aa8cd0e916b10b6aea1bd4c9\n")])])]),s("p",[t._v("可以看到已经生成成功, 且镜像的大小不一样了：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker images")]),t._v("\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\npdai/ubuntu         v1.0.1              b51e9f5f98cd        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" seconds ago       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("92")]),t._v(".1MB\nmysql               latest              791b6e40940c        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" weeks ago         465MB\nubuntu              latest              ccc6e87d482b        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" weeks ago         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v(".2MB\n")])])]),s("h3",{attrs:{id:"_2-6-生成镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-生成镜像"}},[t._v("#")]),t._v(" 2.6 生成镜像")]),t._v(" "),s("blockquote",[s("p",[t._v("那如果是生成一个全新的镜像呢？我们使用命令 docker build ，通过创建一个 Dockerfile 文件，其中包含一组指令来告诉 Docker 如何构建我们的镜像。")])]),t._v(" "),s("p",[t._v("这里特意指定的Base镜像为上一步修改生成的"),s("code",[t._v("pdai/ubuntu:v1.0.1")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("FROM    pdai/ubuntu:v1.0.1\nMAINTAINER      pdai "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pdai.tech"')]),t._v("\n\nRUN     /bin/echo "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root:123456'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("chpasswd\nRUN     "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useradd")]),t._v(" pdai\nRUN     /bin/echo "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pdai:123456'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("chpasswd\nRUN     /bin/echo -e "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LANG='),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("en_US.UTF-8"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v('"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/etc/default/local\nEXPOSE  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("\nEXPOSE  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\nCMD     /usr/sbin/sshd -D\n")])])]),s("p",[s("strong",[t._v("稍微解释下")]),t._v("：这一部分在开发中会用到比较多，所以单独一个章节详解：")]),t._v(" "),s("ul",[s("li",[t._v("每一个指令都会在镜像上创建一个新的层，每一个指令的前缀都必须是大写的。")]),t._v(" "),s("li",[t._v("第一条FROM，指定使用哪个镜像源")]),t._v(" "),s("li",[t._v("RUN 指令告诉docker 在镜像内执行命令，安装了什么。。。")]),t._v(" "),s("li",[t._v("我们使用 Dockerfile 文件，通过 docker build 命令来构建一个镜像。")])]),t._v(" "),s("p",[t._v("接下来生成镜像：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai docker-test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker build -t pdai/ubuntu:v2.0.1 .")]),t._v("\nSending build context to Docker daemon  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(".048kB\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/9 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" FROM    pdai/ubuntu:v1.0.1\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" b51e9f5f98cd\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/9 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" MAINTAINER      pdai "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pdai.tech"')]),t._v("\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" af026ee229ea\nRemoving intermediate container af026ee229ea\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 0e961cb557c9\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("/9 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" RUN     /bin/echo "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root:123456'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("chpasswd\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" 96bd9c40c55e\nRemoving intermediate container 96bd9c40c55e\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 9e8549720043\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("/9 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" RUN     "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useradd")]),t._v(" pdai\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" 0117278f243c\nRemoving intermediate container 0117278f243c\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 87c478df56da\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("/9 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" RUN     /bin/echo "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pdai:123456'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("chpasswd\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" e0381eabe71a\nRemoving intermediate container e0381eabe71a\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 84fd07f978ae\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("/9 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" RUN     /bin/echo -e "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LANG='),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("en_US.UTF-8"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v('"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/etc/default/local\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" 8d0052d9921f\nRemoving intermediate container 8d0052d9921f\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" 3ed0b248224c\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("/9 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" EXPOSE  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" 4b5d540567cd\nRemoving intermediate container 4b5d540567cd\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" c0a72ad140dd\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("/9 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" EXPOSE  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" c9620707d038\nRemoving intermediate container c9620707d038\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" df42b714ecc1\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v("/9 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" CMD     /usr/sbin/sshd -D\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" e178826b43fe\nRemoving intermediate container e178826b43fe\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" a733d5a264b5\nSuccessfully built a733d5a264b5\nSuccessfully tagged pdai/ubuntu:v2.0.1\n\n")])])]),s("p",[t._v("参数说明：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("-t")]),t._v(" ：指定要创建的目标镜像名")]),t._v(" "),s("li",[s("code",[t._v(".")]),t._v(" ：Dockerfile 文件所在目录，可以指定Dockerfile 的绝对路径")])]),t._v(" "),s("p",[t._v("使用docker images 查看创建的镜像已经在列表中存在,镜像ID为a733d5a264b5")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai docker-test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker images")]),t._v("\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\npdai/ubuntu         v2.0.1              a733d5a264b5        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" minutes ago       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("92")]),t._v(".5MB\npdai/ubuntu         v1.0.1              b51e9f5f98cd        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" hours ago        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("92")]),t._v(".1MB\nmysql               latest              791b6e40940c        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" weeks ago         465MB\nubuntu              latest              ccc6e87d482b        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" weeks ago         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v(".2MB\n\n")])])]),s("p",[t._v("我们可以使用新的镜像来创建容器")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai docker-test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -it pdai/ubuntu:v2.0.1 /bin/bash")]),t._v("\nroot@f5332ebce695:/"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# id pdai")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("uid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pdai"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("gid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pdai"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("groups")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pdai"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nroot@f5332ebce695:/"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# exit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n")])])]),s("p",[t._v("从上面看到新镜像已经包含我们创建的用户 pdai。")]),t._v(" "),s("h3",{attrs:{id:"_2-7-镜像标签"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-7-镜像标签"}},[t._v("#")]),t._v(" 2.7 镜像标签")]),t._v(" "),s("blockquote",[s("p",[t._v("设置镜像的Tag，类似于Git中tag？我们可以使用 docker tag 命令，为镜像添加一个新的标签")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker tag a733d5a264b5 pdai/ubuntu:v3.0.1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker images")]),t._v("\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\npdai/ubuntu         v2.0.1              a733d5a264b5        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(" minutes ago       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("92")]),t._v(".5MB\npdai/ubuntu         v3.0.1              a733d5a264b5        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(" minutes ago       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("92")]),t._v(".5MB\npdai/ubuntu         v1.0.1              b51e9f5f98cd        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" hours ago        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("92")]),t._v(".1MB\nmysql               latest              791b6e40940c        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" weeks ago         465MB\nubuntu              latest              ccc6e87d482b        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" weeks ago         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v(".2MB\n")])])]),s("p",[t._v("注意：")]),t._v(" "),s("ul",[s("li",[t._v("docker tag 镜像ID，这里是 a733d5a264b5 ,用户名称、镜像源名(repository name)和新的标签名(tag)。")]),t._v(" "),s("li",[t._v("使用 docker images 命令可以看到，ID为a733d5a264b5的镜像多一个v3.0.1标签。")])]),t._v(" "),s("h3",{attrs:{id:"_2-8-镜像导出和导入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-8-镜像导出和导入"}},[t._v("#")]),t._v(" 2.8 镜像导出和导入")]),t._v(" "),s("blockquote",[s("p",[t._v("区别于容器的导出和导入")])]),t._v(" "),s("ul",[s("li",[t._v("镜像导出")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker images")]),t._v("\ndockREPOSITORY                   TAG                 IMAGE ID            CREATED             SIZE\npdai/ubuntu                  v2.0.2              57544a04cd1a        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" months ago        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("91")]),t._v(".5MB\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker save > pdai-ubuntu-v2.0.2.tar 57544a04cd1a")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ll | grep pdai-u")]),t._v("\n-rw-rw-r-- "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("93898240")]),t._v(" Jun  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" 09:06 pdai-ubuntu-v2.0.2.tar\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n")])])]),s("ul",[s("li",[t._v("镜像导入")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("docker load "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" pdai-ubuntu-v2.0.2.tar\n")])])]),s("p",[t._v("其中"),s("code",[t._v("-i")]),t._v("或者"),s("code",[t._v("<")]),t._v("表示从文件输入。会成功导入镜像及相关元数据，包括tag信息")]),t._v(" "),s("blockquote",[s("p",[t._v("可以依据具体使用场景来选择命令")])]),t._v(" "),s("ul",[s("li",[t._v("若是只想备份images，使用save、load即可")]),t._v(" "),s("li",[t._v("若是在启动容器后，容器内容有变化，需要备份，则使用export、import")])]),t._v(" "),s("h2",{attrs:{id:"_3-docker-容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-docker-容器"}},[t._v("#")]),t._v(" 3. Docker 容器")]),t._v(" "),s("blockquote",[s("p",[t._v("上面已经展示了部分容器的使用命令了，这里会在此基础上进行拓展")])]),t._v(" "),s("h3",{attrs:{id:"_3-1-创建与启动容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-创建与启动容器"}},[t._v("#")]),t._v(" 3.1 创建与启动容器")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("docker run [OPTIONS] IMAGE [COMMAND] [ARG...]\n")])])]),s("p",[t._v("首先我们是可以这样启动容器的：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai docker-test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -it pdai/ubuntu:v2.0.1 /bin/bash")]),t._v("\nroot@f5332ebce695:/"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# id pdai")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("uid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pdai"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("gid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pdai"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("groups")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pdai"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nroot@f5332ebce695:/"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# exit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v("-it")]),t._v(" 可以连写的，表示 "),s("code",[t._v("-i -t")])]),t._v(" "),s("li",[s("code",[t._v("-t")]),t._v(": 在新容器内指定一个伪终端或终端。")]),t._v(" "),s("li",[s("code",[t._v("-i")]),t._v(": 允许你对容器内的标准输入 (STDIN) 进行交互")])]),t._v(" "),s("h4",{attrs:{id:"_3-1-1-参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-1-参数"}},[t._v("#")]),t._v(" 3.1.1 参数")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("-it")]),t._v(" 可以连写的，表示 "),s("code",[t._v("-i -t")])]),t._v(" "),s("li",[s("code",[t._v("-t")]),t._v(": 在新容器内指定一个伪终端或终端。")]),t._v(" "),s("li",[s("code",[t._v("-i")]),t._v(": 允许你对容器内的标准输入 (STDIN) 进行交互")]),t._v(" "),s("li",[t._v("--name：为创建的容器命名；")]),t._v(" "),s("li",[t._v("-v：表示目录映射关系（前者是宿主机目录，后者是映射到宿主机上的目录），可以使用多个 -v 做多个目录或文件映射。注意：最好做目录映射，在宿主机上做修改，然后共享到容器上；")]),t._v(" "),s("li",[t._v("-d：在 run 后面加上 -d 参数，则会创建一个守护式容器在后台运行（这样创建容器后不会自动登录容器，如果只加 -i -t 两个参数，创建容器后就会自动进容器里）；")]),t._v(" "),s("li",[t._v("-p：表示端口映射，前者是宿主机端口，后者是容器内的映射端口。可以使用多个 -p 做多个端口映射。")]),t._v(" "),s("li",[t._v("-P：随机使用宿主机的可用端口与容器内暴露的端口映射。")]),t._v(" "),s("li",[t._v("--restart=always ：创建容器时添加参数 --restart=always 后，当docker重启时，容器自动启动。")])]),t._v(" "),s("h4",{attrs:{id:"_3-1-2-创建并进入容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-2-创建并进入容器"}},[t._v("#")]),t._v(" 3.1.2 创建并进入容器")]),t._v(" "),s("p",[t._v("下面这行命令的意思就是通过镜像 AA 创建一个容器 BB，运行容器并进入容器的"),s("code",[t._v("/bin/bash")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("docker run -it --name 容器名称 镜像名称:标签 /bin/bash\n")])])]),s("p",[t._v("注意："),s("code",[t._v("Docker")]),t._v("容器运行必须有一个前台进程，如果没有前台进程执行，容器认为是空闲状态，就会自动退出。")]),t._v(" "),s("h4",{attrs:{id:"_3-1-3-退出当前容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-3-退出当前容器"}},[t._v("#")]),t._v(" 3.1.3 退出当前容器")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("exit\n")])])]),s("h3",{attrs:{id:"_3-2-容器查看"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-容器查看"}},[t._v("#")]),t._v(" 3.2 容器查看")]),t._v(" "),s("p",[t._v("查看正在运行的容器。")]),t._v(" "),s("p",[t._v("执行命令："),s("code",[t._v("docker ps")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("属性")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("CONTAINER ID")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("容器 ID")])]),t._v(" "),s("tr",[s("td",[t._v("IMAGE")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("所属镜像")])]),t._v(" "),s("tr",[s("td",[t._v("COMMAND")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("启动容器时运行的命令")])]),t._v(" "),s("tr",[s("td",[t._v("CREATED")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("创建时间")])]),t._v(" "),s("tr",[s("td",[t._v("STATUS")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("容器状态")])]),t._v(" "),s("tr",[s("td",[t._v("PORTS")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("端口")])]),t._v(" "),s("tr",[s("td",[t._v("NAMES")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("容器名称")])])])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("查看所有容器（包括运行和停止）。")]),t._v(" "),s("p",[t._v("执行命令："),s("code",[t._v("docker ps -a")])])]),t._v(" "),s("li",[s("p",[t._v("查看停止的容器。")]),t._v(" "),s("p",[t._v("执行命令："),s("code",[t._v("docker ps -f status=exited")])])]),t._v(" "),s("li",[s("p",[t._v("查看最后一次运行的容器。")]),t._v(" "),s("p",[t._v("执行命令："),s("code",[t._v("docker ps -l")])])]),t._v(" "),s("li",[s("p",[t._v("列出最近创建的 n 个容器。")]),t._v(" "),s("p",[t._v("执行命令："),s("code",[t._v("docker ps -n 5")])])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps -a")]),t._v("\nCONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS                      PORTS               NAMES\nf5332ebce695        pdai/ubuntu:v2.0.1   "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" minutes ago      Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" minutes ago                       jolly_kepler\n0a1556ca3c27        ubuntu:latest        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" hours ago                         stoic_hodgkin\n1a51d2f023c9        ubuntu:latest        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/sh -c \'while t…"')]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("137")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago                       gifted_brown\n414bf796cbe4        ubuntu:latest        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago                         pedantic_galileo\n512061ebfa4c        ubuntu:latest        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago                         wizardly_brown\naa5e9ae5e5db        ubuntu:latest        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/echo \'Hello wo…"')]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago                         affectionate_knuth\n")])])]),s("h3",{attrs:{id:"_3-3-容器再启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-容器再启动"}},[t._v("#")]),t._v(" 3.3 容器再启动")]),t._v(" "),s("blockquote",[s("p",[t._v("我们看到，刚才"),s("code",[t._v("pdai/ubuntu:v2.0.1")]),t._v("的实例"),s("code",[t._v("f5332ebce695")]),t._v("已经停止了"),s("code",[t._v("Exited (0) 20 minutes ago")]),t._v("，我们能否再启这个实例？")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker start f5332ebce695")]),t._v("\nf5332ebce695\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps")]),t._v("\nCONTAINER ID        IMAGE                COMMAND             CREATED             STATUS              PORTS               NAMES\nf5332ebce695        pdai/ubuntu:v2.0.1   "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v(" minutes ago      Up "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" seconds        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp      jolly_kepler\n")])])]),s("h3",{attrs:{id:"_3-4-容器停止和重启"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-容器停止和重启"}},[t._v("#")]),t._v(" 3.4 容器停止和重启")]),t._v(" "),s("blockquote",[s("p",[t._v("我们将上述容器停止，再重启")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker stop f5332ebce695")]),t._v("\nf5332ebce695\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps")]),t._v("\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker restart f5332ebce695")]),t._v("\nf5332ebce695\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps -a")]),t._v("\nCONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS                      PORTS               NAMES\nf5332ebce695        pdai/ubuntu:v2.0.1   "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("33")]),t._v(" minutes ago      Up "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" seconds                "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp      jolly_kepler\n0a1556ca3c27        ubuntu:latest        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(" hours ago                         stoic_hodgkin\n1a51d2f023c9        ubuntu:latest        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/sh -c \'while t…"')]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("137")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago                       gifted_brown\n414bf796cbe4        ubuntu:latest        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago                         pedantic_galileo\n512061ebfa4c        ubuntu:latest        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" hours ago                         wizardly_brown\naa5e9ae5e5db        ubuntu:latest        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/echo \'Hello wo…"')]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago                         affectionate_knuth\n")])])]),s("h3",{attrs:{id:"_3-5-后台模式与进入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-后台模式与进入"}},[t._v("#")]),t._v(" 3.5 后台模式与进入")]),t._v(" "),s("blockquote",[s("p",[t._v("在使用 -d 参数时，容器启动后会进入后台, 如何进入容器呢？")])]),t._v(" "),s("ul",[s("li",[t._v("第一种："),s("code",[t._v("docker attach")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps")]),t._v("\nCONTAINER ID        IMAGE                COMMAND             CREATED             STATUS              PORTS               NAMES\nf5332ebce695        pdai/ubuntu:v2.0.1   "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("38")]),t._v(" minutes ago      Up "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" seconds        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp      jolly_kepler\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker attach f5332ebce695")]),t._v("\nroot@f5332ebce695:/"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# echo 'pdai'")]),t._v("\npdai\nroot@f5332ebce695:/"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# exit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps")]),t._v("\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n\n")])])]),s("p",[t._v("看到没，使用"),s("code",[t._v("docker attach")]),t._v("进入后，exit便容器也停止了。")]),t._v(" "),s("ul",[s("li",[t._v("第二种："),s("code",[t._v("docker exec")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker exec -it f5332ebce695 /bin/bash")]),t._v("\nError response from daemon: Container f5332ebce69520fba353f035ccddd4bd42055fbd1e595f916ba7233e26476464 is not running\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker restart f5332ebce695")]),t._v("\nf5332ebce695\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker exec -it f5332ebce695 /bin/bash")]),t._v("\nroot@f5332ebce695:/"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# exit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps")]),t._v("\nCONTAINER ID        IMAGE                COMMAND             CREATED             STATUS              PORTS               NAMES\nf5332ebce695        pdai/ubuntu:v2.0.1   "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),t._v(" minutes ago      Up "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" seconds        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp      jolly_kepler\n\n  \n")])])]),s("p",[t._v("注意：")]),t._v(" "),s("ul",[s("li",[t._v("我特意在容器停止状态下执行了"),s("code",[t._v("docker exec")]),t._v("，是让你看到"),s("code",[t._v("docker exec")]),t._v("是在容器启动状态下用的，且注意下错误信息；")]),t._v(" "),s("li",[s("strong",[t._v("推荐大家使用 "),s("code",[t._v("docker exec")]),t._v(" 命令，因为此退出容器终端，不会导致容器的停止。")])])]),t._v(" "),s("h3",{attrs:{id:"_3-6-容器导出和导入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-容器导出和导入"}},[t._v("#")]),t._v(" 3.6 容器导出和导入")]),t._v(" "),s("blockquote",[s("p",[t._v("在生产环境中，很多时候是无法连接外网的，所以有时候需要用到容器的导入和导出。")])]),t._v(" "),s("ul",[s("li",[t._v("容器的导出")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps")]),t._v("\nCONTAINER ID        IMAGE                COMMAND             CREATED             STATUS              PORTS               NAMES\nf5332ebce695        pdai/ubuntu:v2.0.1   "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),t._v(" minutes ago      Up "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" seconds        "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp      jolly_kepler\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker export f5332ebce695 > ubuntu-pdai-v2.tar")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ll")]),t._v("\n-rw-rw-r-- "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("93891072")]),t._v(" Feb "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(" 09:42 ubuntu-pdai-v2.tar\n\n")])])]),s("p",[t._v("同时你可以发现，导出容器的时候，容器无需关闭。")]),t._v(" "),s("ul",[s("li",[t._v("容器导入")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[root@pdai ~]# docker import ubuntu-pdai-v2.tar pdai/ubuntu:v2.0.2\nsha256:57544a04cd1ad330371ca9142184ff031dc2b6df70df177994477c08fe547b25\n[root@pdai ~]# docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\npdai/ubuntu         v2.0.2              57544a04cd1a        7 seconds ago       91.5MB\npdai/ubuntu         v2.0.1              a733d5a264b5        About an hour ago   92.5MB\npdai/ubuntu         v3.0.1              a733d5a264b5        About an hour ago   92.5MB\npdai/ubuntu         v1.0.1              b51e9f5f98cd        16 hours ago        92.1MB\nmysql               latest              791b6e40940c        2 weeks ago         465MB\nubuntu              latest              ccc6e87d482b        4 weeks ago         64.2MB\n\n")])])]),s("p",[t._v("注意看，SIZE可能是不一样的。")]),t._v(" "),s("h3",{attrs:{id:"_3-7-强制停止容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-强制停止容器"}},[t._v("#")]),t._v(" 3.7 强制停止容器")]),t._v(" "),s("blockquote",[s("p",[t._v("能否强制删除一个正在运行的容器呢？")])]),t._v(" "),s("p",[t._v("显然，加上"),s("code",[t._v("-f")]),t._v("之后是允许的。")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps")]),t._v("\nCONTAINER ID        IMAGE                COMMAND             CREATED             STATUS              PORTS               NAMES\nf5332ebce695        pdai/ubuntu:v2.0.1   "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("         About an hour ago   Up "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" minutes       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("/tcp, "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp      jolly_kepler\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker rm -f f5332ebce695")]),t._v("\nf5332ebce695\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps -a")]),t._v("\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS               NAMES\n0a1556ca3c27        ubuntu:latest       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" hours ago                         stoic_hodgkin\n1a51d2f023c9        ubuntu:latest       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/sh -c \'while t…"')]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("137")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago                       gifted_brown\n414bf796cbe4        ubuntu:latest       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago                         pedantic_galileo\n512061ebfa4c        ubuntu:latest       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago                         wizardly_brown\naa5e9ae5e5db        ubuntu:latest       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/echo \'Hello wo…"')]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago                         affectionate_knuth\n\n")])])]),s("h3",{attrs:{id:"_3-8-清理停止的容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-清理停止的容器"}},[t._v("#")]),t._v(" 3.8 清理停止的容器")]),t._v(" "),s("blockquote",[s("p",[t._v("我们看到上面还有好几个容器出于停止状态，能不能删除它们呢？")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps -a")]),t._v("\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS               NAMES\n0a1556ca3c27        ubuntu:latest       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" hours ago                         stoic_hodgkin\n1a51d2f023c9        ubuntu:latest       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/sh -c \'while t…"')]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("137")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago                       gifted_brown\n414bf796cbe4        ubuntu:latest       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago                         pedantic_galileo\n512061ebfa4c        ubuntu:latest       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("              "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago                         wizardly_brown\naa5e9ae5e5db        ubuntu:latest       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/echo \'Hello wo…"')]),t._v("   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago        Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" hours ago                         affectionate_knuth\n")])])]),s("p",[t._v("清理停止的容器: "),s("code",[t._v("docker container prune")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker container prune")]),t._v("\nWARNING"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" This will remove all stopped containers.\nAre you sure you want to continue? "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("y/N"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" y\nDeleted Containers:\n0a1556ca3c275cc692ecd6d19caed4c5be42578f81b3dfea52b24208790d160a\n1a51d2f023c947f2be2d9a78eb863e854ca302c89bf354654c409e23e7dd25d7\n414bf796cbe403e01b5414f2b6232c6a037af78deee4581f4935c94859b5164e\n512061ebfa4c340eb03833e54d77052e33fb62cd42ab7dd7e09bf0b02a761552\naa5e9ae5e5db1760bdb8c7ddb92e4293cd7b4736be7e97314f3ef44a71bf8930\n\nTotal reclaimed space: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v(".93MB\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps -a")]),t._v("\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n\n  \n")])])]),s("h3",{attrs:{id:"_3-9-容器别名及操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-9-容器别名及操作"}},[t._v("#")]),t._v(" 3.9 容器别名及操作")]),t._v(" "),s("blockquote",[s("p",[t._v("我们上述对容器的操作都是针对容器ID，这个ID是随机的，能否添加一个name对我们自己设置的name操作呢？")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -itd --name pdai-ubuntu-202 pdai/ubuntu:v2.0.2 /bin/bash")]),t._v("\n11de9755a08402d963d263a559a7daf48f4a2188398f258641240b5eb50fbc89\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps")]),t._v("\nCONTAINER ID        IMAGE                COMMAND             CREATED             STATUS              PORTS               NAMES\n11de9755a084        pdai/ubuntu:v2.0.2   "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("         "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" seconds ago       Up "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" seconds                            pdai-ubuntu-202\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker stop pdai-ubuntu-202")]),t._v("\npdai-ubuntu-202\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@pdai ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps -a")]),t._v("\nCONTAINER ID        IMAGE                COMMAND              CREATED              STATUS                     PORTS               NAMES\n11de9755a084        pdai/ubuntu:v2.0.2   "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("          "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" seconds ago       Exited "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" seconds ago                       pdai-ubuntu-202   \n\n  \n")])])]),s("h3",{attrs:{id:"_3-10-容器错误日志"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-10-容器错误日志"}},[t._v("#")]),t._v(" 3.10 容器错误日志")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("例：实时查看docker容器名为user-uat的最后10行日志\ndocker logs -f -t --tail "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" user-uat\n\n例：查看指定时间后的日志，只显示最后100行：\ndocker logs -f -t --since"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-02-08"')]),t._v(" --tail"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(" user-uat\n\n例：查看最近30分钟的日志:\ndocker logs --since 30m user-uat\n\n例：查看某时间之后的日志：\ndocker logs -t --since"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-02-08T13:23:37"')]),t._v(" user-uat\n\n例：查看某时间段日志：\ndocker logs -t --since"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-02-08T13:23:37"')]),t._v(" --until "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-02-09T12:23:37"')]),t._v(" user-uat\n\n例：将错误日志写入文件：\ndocker logs -f -t --since"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2018-02-18"')]),t._v(" user-uat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" error "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" logs_error.txt\n\n  \n")])])]),s("h2",{attrs:{id:"_4-docker-仓库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-docker-仓库"}},[t._v("#")]),t._v(" 4. Docker 仓库")]),t._v(" "),s("p",[t._v("仓库（Repository）是集中存放镜像的地方，它和我们的Maven仓库是一样的。以下介绍一下 Docker Hub。当然不止 docker hub，只是远程的服务商不一样，操作都是一样的。")]),t._v(" "),s("ul",[s("li",[t._v("可以采用共有的仓库，也可以自己搭建Docker Registry;")]),t._v(" "),s("li",[t._v("如果之前有自己的Artifactory或者Nexus，它们同样可以支持Docker Registry功能;")]),t._v(" "),s("li",[t._v("带界面的也可以使用Harbor等;")])]),t._v(" "),s("h2",{attrs:{id:"参考文章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://pdai.tech/md/devops/docker/docker-03-basic2.html",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("Docker基础 - 仓库，镜像，容器详解")]),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);