(window.webpackJsonp=window.webpackJsonp||[]).push([[127],{503:function(s,a,t){"use strict";t.r(a);var e=t(26),_=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"linux内存监控"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux内存监控"}},[s._v("#")]),s._v(" Linux内存监控")]),s._v(" "),t("h2",{attrs:{id:"_1-简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-简介"}},[s._v("#")]),s._v(" 1. 简介")]),s._v(" "),t("p",[s._v("内存监控主要有free 和 vmstat")]),s._v(" "),t("h2",{attrs:{id:"_2-监控命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-监控命令"}},[s._v("#")]),s._v(" 2. 监控命令")]),s._v(" "),t("h3",{attrs:{id:"_2-1-free"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-free"}},[s._v("#")]),s._v(" 2.1 free")]),s._v(" "),t("p",[s._v("Linux free命令用于显示内存状态。")]),s._v(" "),t("p",[s._v("free指令会显示内存的使用情况，包括实体内存，虚拟的交换文件内存，共享内存区段，以及系统核心使用的缓冲区等。")]),s._v(" "),t("h4",{attrs:{id:"_2-1-1-语法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-语法"}},[s._v("#")]),s._v(" 2.1.1 语法")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-bkmotV"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-s "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("间隔秒数"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("常用选项：\n"),t("code",[s._v("-b")]),s._v("：以Byte为单位显示内存使用情况；\n"),t("code",[s._v("-k")]),s._v("：以KB为单位显示内存使用情况；\n"),t("code",[s._v("-m")]),s._v("：以MB为单位显示内存使用情况；\n"),t("code",[s._v("-g")]),s._v("：以GB为单位显示内存使用情况;")]),s._v(" "),t("p",[t("strong",[t("code",[s._v("-h")]),s._v(":  以合适的单位显示内存使用情况，最大为三位数，自动计算对应的单位值。单位有：")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("B = bytes\nK = kilos\nM = megas\nG = gigas\nT = teras\n")])])]),t("p",[t("code",[s._v("-o")]),s._v("：不显示缓冲区调节列；\n"),t("code",[s._v("-t")]),s._v("：显示内存总和列；\n"),t("code",[s._v("-V")]),s._v("：显示版本信息。****")]),s._v(" "),t("p",[t("strong",[t("code",[s._v("-s")]),s._v(": <间隔秒数> 持续观察内存使用状况。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220401101834998.png",alt:"image-20220401101834998"}})]),s._v(" "),t("h4",{attrs:{id:"_2-1-2-字段说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-2-字段说明"}},[s._v("#")]),s._v(" 2.1.2 字段说明：")]),s._v(" "),t("ul",[t("li",[s._v("total：内存总数；")]),s._v(" "),t("li",[s._v("used：已经使用的内存数，包括 cached 和应用程序实际使用的内存；")]),s._v(" "),t("li",[s._v("free：空闲的内存数；")]),s._v(" "),t("li",[s._v("shared：当前已经废弃不用；")]),s._v(" "),t("li",[s._v("buffers：缓存内存数；")]),s._v(" "),t("li",[s._v("cached：缓存内存数。")])]),s._v(" "),t("p",[s._v("关系：total = used +available")]),s._v(" "),t("h4",{attrs:{id:"_2-1-3-实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-实例"}},[s._v("#")]),s._v(" 2.1.3 实例")]),s._v(" "),t("h5",{attrs:{id:"_2-1-3-1-显示内存使用情况"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-1-显示内存使用情况"}},[s._v("#")]),s._v(" 2.1.3.1 显示内存使用情况")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("free\n")])])]),t("p",[t("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220401141256030.png",alt:"image-20220401141256030"}})]),s._v(" "),t("h5",{attrs:{id:"_2-1-3-2-以合适的单位显示内存使用情况"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-2-以合适的单位显示内存使用情况"}},[s._v("#")]),s._v(" 2.1.3.2 以合适的单位显示内存使用情况")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220401141510962.png",alt:"image-20220401141510962"}})]),s._v(" "),t("h5",{attrs:{id:"_2-1-3-3-以总和的形式显示内存的使用信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-3-以总和的形式显示内存的使用信息"}},[s._v("#")]),s._v(" 2.1.3.3 以总和的形式显示内存的使用信息")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" -t\n")])])]),t("p",[t("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220401141403556.png",alt:"image-20220401141403556"}})]),s._v(" "),t("h5",{attrs:{id:"_2-1-3-4-周期性的查询内存使用信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-3-4-周期性的查询内存使用信息"}},[s._v("#")]),s._v(" 2.1.3.4 周期性的查询内存使用信息")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" //每10s 执行一次命令\n")])])]),t("p",[t("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220401141645744.png",alt:"image-20220401141645744"}})]),s._v(" "),t("h4",{attrs:{id:"_2-1-4-tldr-中的介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-4-tldr-中的介绍"}},[s._v("#")]),s._v(" 2.1.4 tldr 中的介绍")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("base"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ➜  ~ tldr "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("\n\n  Display amount of "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" and used memory "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" the system.\n  显示系统中可用和已使用的内存量。\n\n  - Display system memory:\n  \t显示系统内存:\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("\n\n  - Display memory "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" Bytes/KB/MB/GB:\n  \t以字节/KB/MB/GB为单位显示内存:\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" -b"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("k"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("m"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("g\n\n  - Display memory "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" human readable units:\n  \t以人类可读单位显示内存:\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" -h\n\n  - Refresh the output every "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" seconds:\n  \t每2秒刷新一次输出:\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" -s "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])])]),t("h3",{attrs:{id:"_2-2-vmstat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-vmstat"}},[s._v("#")]),s._v(" 2.2 vmstat")]),s._v(" "),t("h4",{attrs:{id:"_2-2-1-简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-简介"}},[s._v("#")]),s._v(" 2.2.1 简介")]),s._v(" "),t("p",[s._v("mstat命令 的含义为显示虚拟内存状态（“Viryual Memor Statics”），但是它可以报告关于进程、内存、I/O等系统整体运行状态。")]),s._v(" "),t("h4",{attrs:{id:"_2-2-2-语法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-语法"}},[s._v("#")]),s._v(" 2.2.2 语法")]),s._v(" "),t("div",{staticClass:"language-erlang extra-class"},[t("pre",{pre:!0,attrs:{class:"language-erlang"}},[t("code",[t("span",{pre:!0,attrs:{class:"token atom"}},[s._v("vmstat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("选项"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("参数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("p",[s._v("选项\n"),t("code",[s._v("-a")]),s._v("：显示活动内页；\n"),t("code",[s._v("-f")]),s._v("：显示启动后创建的进程总数；\n"),t("code",[s._v("-m")]),s._v("：显示slab信息；\n"),t("code",[s._v("-n")]),s._v("：头信息仅显示一次；\n"),t("code",[s._v("-s")]),s._v("：以表格方式显示事件计数器和内存状态；\n"),t("code",[s._v("-d")]),s._v("：报告磁盘状态；\n"),t("code",[s._v("-p")]),s._v("：显示指定的硬盘分区状态；\n"),t("code",[s._v("-S")]),s._v("：输出信息的单位。")]),s._v(" "),t("p",[s._v("参数")]),s._v(" "),t("ul",[t("li",[s._v("事件间隔：状态信息刷新的时间间隔；")]),s._v(" "),t("li",[s._v("次数：显示报告的次数")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220401141913473.png",alt:"image-20220401141913473"}})]),s._v(" "),t("h4",{attrs:{id:"_2-2-3-字段说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-字段说明"}},[s._v("#")]),s._v(" 2.2.3 字段说明")]),s._v(" "),t("p",[s._v("Procs（进程）")]),s._v(" "),t("ul",[t("li",[s._v("r: 运行和等待CPU时间片的进程数，这个值如果长期大于系统CPU个数，就说明CPU资源不足，可以考虑增加CPU")]),s._v(" "),t("li",[s._v("b: 等待资源的进程数，比如正在等待I/O或者内存交换等")])]),s._v(" "),t("p",[s._v("Memory（内存）")]),s._v(" "),t("ul",[t("li",[s._v("swpd: 使用虚拟内存大小，如果swpd的值不为0，但是SI，SO的值长期为0，这种情况不会影响系统性能。")]),s._v(" "),t("li",[s._v("free: 空闲物理内存大小（以KB为单位）。")]),s._v(" "),t("li",[s._v("buff: 用作缓冲的内存大小。")]),s._v(" "),t("li",[s._v("cache: 用作缓存的内存大小，如果cache的值大的时候，说明cache处的文件数多。如果此时IO中的bi比较小，就说明文件系统效率比较好。")])]),s._v(" "),t("p",[s._v("Swap")]),s._v(" "),t("ul",[t("li",[s._v("si: 每秒从交换区写到内存的大小，由磁盘调入内存。")]),s._v(" "),t("li",[s._v("so: 每秒写入交换区的内存大小，由内存调入磁盘。")])]),s._v(" "),t("p",[s._v("注意：内存够用的时候，这2个值都是0，如果这2个值长期大于0时，系统性能会受到影响，磁盘IO和CPU资源都会被消耗。有些朋友看到空闲内存（free）很少的或接近于0时，就认为内存不够用了，不能光看这一点，还要结合si和so，如果free很少，但是si和so也很少（大多时候是0），那么不用担心，系统性能这时不会受到影响的。")]),s._v(" "),t("p",[s._v("IO（现在的Linux版本块的大小为1kb）")]),s._v(" "),t("ul",[t("li",[s._v("bi: 每秒读取的块数")]),s._v(" "),t("li",[s._v("bo: 每秒写入的块数")])]),s._v(" "),t("p",[s._v("注意：随机磁盘读写的时候，这2个值较大（如超出1024k)，而且wa值比较大，则表示系统磁盘IO性能瓶颈。")]),s._v(" "),t("p",[s._v("system（系统）")]),s._v(" "),t("ul",[t("li",[s._v("in: 每秒中断数，包括时钟中断。")]),s._v(" "),t("li",[s._v("cs: 每秒上下文切换数。")])]),s._v(" "),t("p",[s._v("注意：上面2个值越大，会看到由内核消耗的CPU时间会越大。")]),s._v(" "),t("p",[s._v("CPU（以百分比表示）\nus: 用户进程执行时间百分比(user time)\nus的值比较高时，说明用户进程消耗的CPU时间多，但是如果长期超50%的使用，那么我们就该考虑优化程序算法或者进行加速。")]),s._v(" "),t("ul",[t("li",[s._v("sy: 内核系统进程执行时间百分比(system time)")])]),s._v(" "),t("p",[s._v("sy的值高时，说明系统内核消耗的CPU资源多，这并不是良性表现，我们应该检查原因。")]),s._v(" "),t("ul",[t("li",[s._v("id: 空闲时间百分比")]),s._v(" "),t("li",[s._v("wa: IO等待时间百分比")])]),s._v(" "),t("p",[s._v("wa的值高时，说明IO等待比较严重，这可能由于磁盘大量作随机访问造成，也有可能磁盘出现瓶颈（块操作）。")]),s._v(" "),t("ul",[t("li",[s._v("st：一般不关注，虚拟机占用的时间百分比。")])]),s._v(" "),t("h4",{attrs:{id:"_2-2-4-实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-4-实例"}},[s._v("#")]),s._v(" 2.2.4 实例")]),s._v(" "),t("p",[s._v("每2s显示一次")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/image-20220401141913473.png",alt:"image-20220401141913473"}})])])}),[],!1,null,null,null);a.default=_.exports}}]);