(window.webpackJsonp=window.webpackJsonp||[]).push([[930],{1310:function(e,n,a){"use strict";a.r(n);var t=a(26),s=Object(t.a)({},(function(){var e=this,n=e.$createElement,a=e._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"四种解决nginx出现403-forbidden-报错的方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四种解决nginx出现403-forbidden-报错的方法"}},[e._v("#")]),e._v(" 四种解决Nginx出现403 forbidden 报错的方法")]),e._v(" "),a("h2",{attrs:{id:"_1-背景-访问时报403"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-背景-访问时报403"}},[e._v("#")]),e._v(" 1.背景：访问时报403")]),e._v(" "),a("p",[e._v("nginx 访问静态资源文件提示")]),e._v(" "),a("p",[a("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/img/image-20190908163131411.png",alt:"image-20190908163131411"}})]),e._v(" "),a("p",[e._v("于是查看nginx日志，路径为/var/log/nginx/error.log。打开日志发现报错Permission denied，详细报错如下：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('2021/08/31 16:06:44 [error] 32713#32713: *5 open() "/home/faduit/data/upload//blYctsOfficialSealController20210831152014.png" failed (13: Permission denied), client: 10.8.0.23, server: 192.168.134.3, request: "GET /upload/blYctsOfficialSealController20210831152014.png HTTP/1.1", host: "192.168.134.3"\n')])])]),a("h2",{attrs:{id:"_2-解决方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-解决方式"}},[e._v("#")]),e._v(" 2. 解决方式")]),e._v(" "),a("h3",{attrs:{id:"_2-1-方式1-由于启动用户和nginx工作用户不一致所致"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-方式1-由于启动用户和nginx工作用户不一致所致"}},[e._v("#")]),e._v(" 2.1 方式1："),a("strong",[e._v("由于启动用户和nginx工作用户不一致所致")])]),e._v(" "),a("ol",[a("li",[a("p",[e._v("查看nginx启动的用户")]),e._v(" "),a("p",[e._v("发现是nobody，而为是用root启动的")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" ps axu|grep 'nginx'\n")])])]),a("p",[e._v("out")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("nobody      4936  0.0  0.0  45864  1176 ?        Ss   8月17   0:00 nginx: master process /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf\n")])])])]),e._v(" "),a("li",[a("p",[e._v("将nginx.config的user改为和启动用户一致")]),e._v(" "),a("p",[e._v("命令：vi conf/nginx.conf")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(" #user nobody;\n user root;\n")])])])])]),e._v(" "),a("h3",{attrs:{id:"_2-2-方式2-权限问题-如果nginx没有web目录的操作权限-也会出现403错误。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-方式2-权限问题-如果nginx没有web目录的操作权限-也会出现403错误。"}},[e._v("#")]),e._v(" 2.2  方式2：权限问题，如果nginx没有web目录的操作权限，也会出现403错误。")]),e._v(" "),a("p",[e._v("解决办法：修改web目录的读写权限，或者是把nginx的启动用户改成目录的所属用户，重启Nginx即可解决")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("chmod -R 777 /data")])]),e._v(" "),a("li",[a("p",[e._v("chmod -R 777 /data/www/")])])]),e._v(" "),a("h4",{attrs:{id:"_2-3-方式3-缺少index-html或者index-php文件-就是配置文件中index-index-html-index-htm这行中的指定的文件。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-方式3-缺少index-html或者index-php文件-就是配置文件中index-index-html-index-htm这行中的指定的文件。"}},[e._v("#")]),e._v(" 2.3 方式3："),a("strong",[e._v("缺少index.html或者index.php文件，就是配置文件中index index.html index.htm这行中的指定的文件。")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("server {\n\n   listen 80;\n\n  server_name localhost;\n\n  index index.php index.html;\n\n  root /data/www/;\n\n}\n")])])]),a("p",[e._v("如果把它当做文件目录，要列出文件目录")]),e._v(" "),a("p",[e._v("添加:\tautoindex on;")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("# 文件服务器\n    server {\n        listen       80;\n        server_name  file.isture.com;\n\n        location / {\n            root   /home/ftpuser/file;\n            autoindex on;\n        }\n    }\n")])])]),a("h3",{attrs:{id:"_2-4-方式4-selinux设置为开启状态-enabled-的原因。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-方式4-selinux设置为开启状态-enabled-的原因。"}},[e._v("#")]),e._v(" 2.4 方式4："),a("strong",[e._v("SELinux设置为开启状态（enabled）的原因。")])]),e._v(" "),a("p",[e._v("查看当前selinux的状态。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("/usr/sbin/sestatus\n")])])]),a("p",[e._v("将SELINUX=enforcing 修改为 SELINUX=disabled 状态。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("vi /etc/selinux/config\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("#SELINUX=enforcing\n\n SELINUX=disabled\n")])])]),a("p",[e._v("重启生效。reboot。")]),e._v(" "),a("hr"),e._v(" "),a("p",[e._v("不想重启的可以使用临时关闭")]),e._v(" "),a("p",[e._v("临时关闭（不用重启机器）：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("setenforce 0          ##设置SELinux 成为permissive模式\n\n \\##setenforce 1 设置SELinux 成为enforcing模式\n")])])]),a("h2",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[e._v("#")]),e._v(" 参考文章")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://blog.51cto.com/bguncle/957315",target:"_blank",rel:"noopener noreferrer"}},[e._v("查看 SELinux状态及关闭SELinux"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/shadow_zed/article/details/106853355",target:"_blank",rel:"noopener noreferrer"}},[e._v("四种解决Nginx出现403 forbidden 报错的方法"),a("OutboundLink")],1)])])}),[],!1,null,null,null);n.default=s.exports}}]);