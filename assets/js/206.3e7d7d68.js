(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{583:function(s,t,a){"use strict";a.r(t);var n=a(26),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"linux安装mongodb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux安装mongodb"}},[s._v("#")]),s._v(" linux安装mongoDB")]),s._v(" "),a("h2",{attrs:{id:"_1-下载linux版本mongodb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载linux版本mongodb"}},[s._v("#")]),s._v(" 1.下载linux版本mongoDB")]),s._v(" "),a("p",[s._v("访问mongoDB官网，选择对应版本"),a("a",{attrs:{href:"https://www.mongodb.com/try/download/community",target:"_blank",rel:"noopener noreferrer"}},[s._v("mongodb官网"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/image-20210406231806650.png",alt:"image-20210406231806650"}})]),s._v(" "),a("p",[s._v("选择对应的版本")]),s._v(" "),a("h2",{attrs:{id:"_2-安装mongodb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装mongodb"}},[s._v("#")]),s._v(" 2. 安装mongodb")]),s._v(" "),a("p",[s._v("可以选择download 后上传服务器，或cope link")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("使用wget下载tgz包，我当前目录/usr/local/")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-4.4.4.tgz\n")])])])]),s._v(" "),a("li",[a("p",[s._v("解压")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf mongodb-linux-x86_64-rhel70-4.4.4.tgz\n")])])])]),s._v(" "),a("li",[a("p",[s._v("移动到mongodb目录")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" mongodb-linux-x86_64-rhel70-4.4.4/ mongodb\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"_3-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置"}},[s._v("#")]),s._v(" 3. 配置")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("在mongoDB根目录下创建data目录及其子目录db，以及日志目录logs以及其日志文件mongoLogs.log，和配置文件mongodb.conf，命令如下")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /home/mongodb/db\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /home/mongodb/logs/\n")])])])]),s._v(" "),a("li",[a("p",[s._v("编辑配置文件mongodb.conf，命令如下")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库文件位置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dbpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/mongodb/db\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#日志文件位置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("logpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/mongodb/logs/mongo.log\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否追加方式写入日志，默认True")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("logappend")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置绑定ip")]),s._v("\nbind_ip "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置端口")]),s._v("\nport "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27017")]),s._v("\n  \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这个选项可以过滤掉一些无用的日志信息，若需要调试使用请设置为false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("quiet")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启用日志文件，默认启用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("journal")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true\n\n\n")])])])]),s._v(" "),a("li",[a("p",[s._v("配置启动脚本：startup.sh")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("bin/mongod --config "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./mongodb.conf"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("配置停止脚本：shutdown.sh")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("mongod --shutdown  --dbpath /home/db/\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"_4-启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-启动"}},[s._v("#")]),s._v(" 4. 启动")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("启动命令")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sh startup.sh\n")])])])]),s._v(" "),a("li",[a("p",[s._v("停止命令")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sh shutdown.sh\n")])])])]),s._v(" "),a("li",[a("p",[s._v("mongo连接测试")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("./mongo\n")])])]),a("p",[a("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/image-20210406233633436.png",alt:"image-20210406233633436"}})])])]),s._v(" "),a("h2",{attrs:{id:"_5-配置账户-授权登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-配置账户-授权登录"}},[s._v("#")]),s._v(" 5. 配置账户，授权登录")]),s._v(" "),a("p",[s._v("mongodb我们已经安装完成，也成功启动连接上了测试库，但此时我们./mongo启动的时候是默认不需要授权登录的，这样并不安全，所以我们需要创建管理员，之后启动及操作都需要授权登录才可以进行。")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("创建admin数据库，创建用户，设置账号，密码，权限")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use admin\nswitched to db admin\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.createUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("user:"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(",pwd:"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v(",roles:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nSuccessfully added user: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"roles"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("使用账号密码登录后，结束mongodb程序")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use admin\nswitched to db admin\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.auth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.shutdownServer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nError: shutdownServer failed: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ok"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"errmsg"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shutdown must run from localhost when running db without auth"')]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"code"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"codeName"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Unauthorized"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\n_getErrorWithCode@src/mongo/shell/utils.js:25:13\nDB.prototype.shutdownServer@src/mongo/shell/db.js:426:19\n@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shell"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":1:1\n\n")])])])]),s._v(" "),a("li",[a("p",[s._v("修改配置文件，重启使配置生效")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 末尾添加上\n#开启身份验证\nauth = true\n")])])])]),s._v(" "),a("li",[a("p",[s._v("重启")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("./mongod --config /usr/local/mongoDB/mongodb.conf\n")])])])]),s._v(" "),a("li",[a("p",[s._v("以管理员账号登录，创建普通用户，之后本地做开发连接数据库时需要配置账号密码才可以成功连接")]),s._v(" "),a("div",{staticClass:"language-ssh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('1，以管理员账号连接数据库\n[root@izbp1b498epn4trb75oykez bin]# ./mongo 127.0.0.1:27017/admin --username "root" --password "123456"\n2，创建数据库,创建账号，给读写权限\n> use blog\n> db.createUser({user:"blogAdmin",pwd:"123456",roles:[{role:"readWrite",db:"blog"}]})\nSuccessfully added user: {\n\t"user" : "blogAdmin",\n\t"roles" : [\n    \t{\n\t    \t"role" : "readWrite",\n\t    \t"db" : "blog"\n    \t}\n\t]\n}\n\n')])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);