(window.webpackJsonp=window.webpackJsonp||[]).push([[198],{575:function(t,e,a){"use strict";a.r(e);var l=a(26),s=Object(l.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"mongodb数据导入与导出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb数据导入与导出"}},[t._v("#")]),t._v(" MongoDB数据导入与导出")]),t._v(" "),a("h2",{attrs:{id:"_1-简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-简介"}},[t._v("#")]),t._v(" 1. 简介")]),t._v(" "),a("p",[t._v("MongoDB官方提供了两套数据导入导出工具，一般来说，")]),t._v(" "),a("ul",[a("li",[t._v("mongodump和mongorestore\n"),a("ul",[a("li",[t._v("进行整库导出导入时使用")]),t._v(" "),a("li",[t._v("操作的数据是BSON格式，进行大量dump和restore时效率较高。")])])]),t._v(" "),a("li",[t._v("mongoexport和mongoimport\n"),a("ul",[a("li",[t._v("进行单个集合导出导入时使用")]),t._v(" "),a("li",[t._v("操作的数据是JSON格式，可读性较高")])])])]),t._v(" "),a("h2",{attrs:{id:"_2-mongoexport-导出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-mongoexport-导出"}},[t._v("#")]),t._v(" 2. mongoexport（导出）")]),t._v(" "),a("h3",{attrs:{id:"_2-1-参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-参数"}},[t._v("#")]),t._v(" 2.1 参数")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("命令")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("全称")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("默认值")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("参考释义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--help")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("查看mongoexport的使用帮助")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--version")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("查看mongoexport的版本号")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("-d")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--db "),a("database")],1),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("指定要在哪个数据库上运行该命令")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("-c")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--collection "),a("collection")],1),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("指定要导出的集合")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("-f")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--fields <field1[,field2]>")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("指定导出时只导出一个或多个字段，导出多个时，需要使用逗号分隔; 当字段中有空格时，需要用英文引号括起来。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("-q")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--query "),a("JSON")],1),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("导出指定查询条件的数据")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--type "),a("string")],1),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("json")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("指定要导出的文件类型，可选值：json，csv")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("-o")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--out "),a("file")],1),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("指定要导出的文件路径（含文件名），如果不指定，则会导出为标准输出（例如stdout）")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--limit")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("查询几条数据")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--skip")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("跳过指定数量的数据")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("--sort")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("排序规则")])])])]),t._v(" "),a("h3",{attrs:{id:"_2-2-举例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-举例"}},[t._v("#")]),t._v(" 2.2 举例")]),t._v(" "),a("p",[t._v("导出mytest数据库中的user集合到user.json文件中")]),t._v(" "),a("div",{staticClass:"language-groovy extra-class"},[a("pre",{pre:!0,attrs:{class:"language-groovy"}},[a("code",[t._v("D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\tool\\mongodb"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("server\\bin\\mongoexport"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("collection myCollection "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("db myDB "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("o D"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\data\\myCollection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("json\n")])])]),a("p",[a("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/img/image-20210104144117228.png",alt:"image-20210104144117228"}})]),t._v(" "),a("h2",{attrs:{id:"_3-mongoimport-导入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-mongoimport-导入"}},[t._v("#")]),t._v(" 3. mongoimport（导入）")]),t._v(" "),a("h3",{attrs:{id:"_3-1-参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-参数"}},[t._v("#")]),t._v(" 3.1 参数")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("命令")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("可选值")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("参考释义")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("--ignoreBlanks")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("忽略要导入文件中的空字段，如果不指定该参数，则默认会读取空字段并创建")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("--type <json|csv|tsv>")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("json，csv，tsv")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("要导入的文件类型，另外支持tsv")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("--headerline")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("使用第一行作为字段名称")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("--mode <insert|upsert|merge>")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("insert（插入）， upsert（替换数据库中的文档）， merge（合并）")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("指定导入过程中，如何应对数据库文档与导入文件中的文档匹配 （默认会使用_id字段对比）的情况")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("--drop")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("导入之前drop集合")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("--stopOnError")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("选项指定在mongorestore"),a("strong",[t._v("还原导入时一出错就中止")]),t._v("，默认情况下， 当mongorestore遇到主键重复或文档较验失败等错误时，导入进程并不会中止。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("--maintainInsertionOrder")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("选项从版本4.2开始引入，如果指定该选项，"),a("strong",[t._v("mongorestore在还原导入文档时以实际导出时的插入顺序一致")]),t._v("，这其中包括批量写文档的顺序以及在批量中文档的插入顺序，在早期版本中只能保证批量写文档的顺序。如果指定该选项同时也指定了选项")])])])]),t._v(" "),a("p",[t._v("其他参数与mongoexport基本一致")]),t._v(" "),a("h3",{attrs:{id:"_3-2-举例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-举例"}},[t._v("#")]),t._v(" 3.2 举例")]),t._v(" "),a("p",[t._v("从user.json文件导入到mytest数据库中的user集合，并在之前进行删除")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("mongoimport "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--drop -d mytest -c user --file F:\\bk\\user.json")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/img/image-20210104144243185.png",alt:"image-20210104144243185"}})]),t._v(" "),a("h2",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/dbabd/p/13259147.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MongoDB 逻辑还原工具mongorestore "),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/qq_16313365/article/details/56494522",target:"_blank",rel:"noopener noreferrer"}},[t._v("MongoDB学习（六）数据库的备份、还原、导入及导出"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000012330284",target:"_blank",rel:"noopener noreferrer"}},[t._v("Docker MongoDB 数据库备份 并复制到宿主 恢复"),a("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=s.exports}}]);