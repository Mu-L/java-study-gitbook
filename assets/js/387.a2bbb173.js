(window.webpackJsonp=window.webpackJsonp||[]).push([[387],{763:function(t,e,r){"use strict";r.r(e);var s=r(26),_=Object(s.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"solr查询解析器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#solr查询解析器"}},[t._v("#")]),t._v(" Solr查询解析器")]),t._v(" "),r("h2",{attrs:{id:"_1-简介"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-简介"}},[t._v("#")]),t._v(" 1. 简介")]),t._v(" "),r("p",[t._v("查询解析器用于将查询语句（q参数）解析成搜索语法。")]),t._v(" "),r("h2",{attrs:{id:"_2-常用的三种解析器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-常用的三种解析器"}},[t._v("#")]),t._v(" 2. 常用的三种解析器")]),t._v(" "),r("h3",{attrs:{id:"_2-1-默认解析器-lucene"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-默认解析器-lucene"}},[t._v("#")]),t._v(" 2.1 默认解析器：lucene")]),t._v(" "),r("p",[t._v("Solr在查询的时候，用到了QueryParser对用户输入做解析，solr默认使用的解析器是lucene，被称之为Standard Query Parser。Standard Query Parser支持原生的查询语法，使你可以方便地构造结构化查询语句。当然，它还有不好的，就是容错比较差，总是把错误抛出来，而不是像dismax一样消化掉。")]),t._v(" "),r("h3",{attrs:{id:"_2-2-dismax解析器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-dismax解析器"}},[t._v("#")]),t._v(" 2.2 DisMax解析器")]),t._v(" "),r("h4",{attrs:{id:"_2-2-1-简介"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-简介"}},[t._v("#")]),t._v(" 2.2.1 简介")]),t._v(" "),r("p",[t._v("Dismax查询只是由子查询生成的文档的并集，并对由子查询生成的每个文档打分。 一般来说，DisMax查询解析器的接口更像是Google的接口，而不是标准的Solr请求处理程序的接口。 这种相似性使得DisMax成为许多消费者应用程序的适当的查询解析器。")]),t._v(" "),r("p",[t._v("说人话区别")]),t._v(" "),r("ol",[r("li",[t._v("方便为每个域添加权重，影响评分")]),t._v(" "),r("li",[t._v("接口更想是google 的接口，而不是solr/lucene")]),t._v(" "),r("li",[t._v("很少抛出异常给用户")])]),t._v(" "),r("h4",{attrs:{id:"_2-2-2-dismax-参数"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-dismax-参数"}},[t._v("#")]),t._v(" 2.2.2 DisMax 参数")]),t._v(" "),r("p",[t._v("除了通用的查询参数，DisMax还有一些自有的查询参数，你可以在solrconfig.xml中配置这些参数，或者在查询的时候指定，这样会覆盖之前配置的值。")]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("参数")]),t._v(" "),r("th",[t._v("描述")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("q")]),t._v(" "),r("td",[t._v("查询参数q")])]),t._v(" "),r("tr",[r("td",[t._v("q.alt")]),t._v(" "),r("td",[t._v("如果参数q没有指定，就使用standard query parser并代替参数q")])]),t._v(" "),r("tr",[r("td",[r("strong",[t._v("qf")])]),t._v(" "),r("td",[r("strong",[t._v("Query Fields：在哪些字段上去检索数据。如果不指定的话，使用df")])])]),t._v(" "),r("tr",[r("td",[r("strong",[t._v("mm")])]),t._v(" "),r("td",[r("strong",[t._v("Minimum Match：指定最小匹配因子")])])]),t._v(" "),r("tr",[r("td",[r("strong",[t._v("pf")])]),t._v(" "),r("td",[r("strong",[t._v("Phrase Fields：增加文档的得分如果q参数值离的很近")])])]),t._v(" "),r("tr",[r("td",[t._v("ps")]),t._v(" "),r("td",[t._v("Phrase Slop：指定q参数中两个词可以距离多远")])]),t._v(" "),r("tr",[r("td",[t._v("qs")]),t._v(" "),r("td",[t._v("Query Phrase Slop：指定q参数中两个词可以距离多远，与qf搭配使用")])]),t._v(" "),r("tr",[r("td",[t._v("tie")]),t._v(" "),r("td",[t._v("Tie Breaker：使用一个0到1之间的浮点数")])]),t._v(" "),r("tr",[r("td",[r("strong",[t._v("bq")])]),t._v(" "),r("td",[r("strong",[t._v("Boost Query：指定一个额外因素来增加匹配到的文档的得分")])])]),t._v(" "),r("tr",[r("td",[r("strong",[t._v("bf")])]),t._v(" "),r("td",[r("strong",[t._v("Boost Functions:指定boosts使用的函数")])])])])]),t._v(" "),r("h4",{attrs:{id:"_2-2-3-dismax-query-parser使用举例"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3-dismax-query-parser使用举例"}},[t._v("#")]),t._v(" 2.2.3 DisMax Query Parser使用举例")]),t._v(" "),r("ul",[r("li",[r("p",[t._v('使用StandardRequestHandler查询"video"\nhttp://localhost:8983/solr/select?q=video&fl=name+score')])]),t._v(" "),r("li",[r("p",[t._v("已经配置了查询字段：text、features、name、id、manu、cat。而且匹配上name和cat会有更高的得分\nhttp://localhost:8983/solr/select?defType=dismax&q=video")])]),t._v(" "),r("li",[r("p",[t._v("可以将score显示出来，看一下各个文档的得分\nhttp://localhost:8983/solr/select?defType=dismax&q=video&fl=*,score")])]),t._v(" "),r("li",[r("p",[t._v("现在想设置features有更高的得分，而text有较低的得分\nhttp://localhost:8983/solr/select?defType=dismax&q=video&qf=features^20.0+text^0.3")])]),t._v(" "),r("li",[r("p",[t._v("现在希望某一字段在满足某一情况下有更高的得分\nhttp://localhost:8983/solr/select?defType=dismax&q=video&bq=cat:electronics^5.0")])]),t._v(" "),r("li",[r("p",[t._v("现在想使用有另外一个为instock的handler，它配置了一个过滤器：inStock:true\nhttp://localhost:8983/solr/select?defType=dismax&q=video&qt=instock&fl=name,score,inStock")])]),t._v(" "),r("li",[r("p",[t._v("如果查询短语的单词是一个或者两个，原则上返回的结果中必须包含全部单词，但是你的查询短语很长，solr允许有单词不匹配。你可以通过mm参数设置最多有多少单词不匹配。\nhttp://localhost:8983/solr/select?defType=dismax&q=belkin+ipod+gibberish")])]),t._v(" "),r("li",[r("p",[t._v("可以通过调试功能验证你的想法。\nhttp://localhost:8983/solr/select?defType=dismax&q=belkin+ipod+gibberish&debugQuery=true")])])]),t._v(" "),r("h3",{attrs:{id:"_2-3-edismax"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-edismax"}},[t._v("#")]),t._v(" 2.3 eDisMax")]),t._v(" "),r("p",[t._v("Extended DisMax")]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("参数")]),t._v(" "),r("th",[t._v("说明")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("mm.autoRelax")]),t._v(" "),r("td",[t._v("如果设置为true,可以使mm参数暂时失效：比如stopwords和fq可能会使查询结果为空")])]),t._v(" "),r("tr",[r("td",[t._v("boost")]),t._v(" "),r("td",[t._v("对于匹配的文档，越多的字符串匹配将会取得更高的得分")])]),t._v(" "),r("tr",[r("td",[t._v("lowercaseOperators")]),t._v(" "),r("td",[t._v("这个参数可以用来指示是否把or和and当做OR和AND处理")])]),t._v(" "),r("tr",[r("td",[t._v("ps")]),t._v(" "),r("td",[t._v("短语查询时，默认的溢出量amount of slop，用来影响boosting")])]),t._v(" "),r("tr",[r("td",[t._v("pf2")]),t._v(" "),r("td",[t._v("指定多值的字段可选的权重")])]),t._v(" "),r("tr",[r("td",[t._v("ps2")]),t._v(" "),r("td",[t._v("与pf2搭配使用，没有指定的话，使用ps")])]),t._v(" "),r("tr",[r("td",[t._v("pf3")]),t._v(" "),r("td",[t._v("指定多值的字段可选的权重")])]),t._v(" "),r("tr",[r("td",[t._v("ps3")]),t._v(" "),r("td",[t._v("与pf3搭配使用，没有指定的话，使用ps")])]),t._v(" "),r("tr",[r("td",[t._v("stopwords")]),t._v(" "),r("td",[t._v("布尔值，设置是否StopFilterFactory生效，设为false，则stopwords停词不起作用")])]),t._v(" "),r("tr",[r("td",[t._v("uf")]),t._v(" "),r("td",[t._v("设置用户可以使用那些字段检索，默认是所有字段，也就是uf="),r("em",[t._v("；设置为uf=title,就是只让查询title字段；设置为uf=")]),t._v("-title，就是禁止查询title字段；设置为uf=-*屏蔽所有字段的检索")])])])]),t._v(" "),r("h2",{attrs:{id:"参考文章"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://codeantenna.com/a/liB2jbkEqX",target:"_blank",rel:"noopener noreferrer"}},[t._v("solr 查询解析器"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("a",{attrs:{href:"https://blog.csdn.net/boonya/article/details/55000047",target:"_blank",rel:"noopener noreferrer"}},[t._v("Solr Dismax示例"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("a",{attrs:{href:"https://www.w3cschool.cn/solr_doc/solr_doc-vpyf2gn1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Solr查询：DisMax查询解析器"),r("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=_.exports}}]);