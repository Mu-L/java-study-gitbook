import{_ as r,W as p,X as l,Y as a,Z as n,$ as e,a0 as t,D as o}from"./framework-0cf5f349.js";const c={},i=t(`<h1 id="mysql-备份" tabindex="-1"><a class="header-anchor" href="#mysql-备份" aria-hidden="true">#</a> MySQL - 备份</h1><h2 id="_1-简介" tabindex="-1"><a class="header-anchor" href="#_1-简介" aria-hidden="true">#</a> 1. 简介</h2><p>备份方案主要分为</p><ul><li>xtrabackup</li></ul><h2 id="_2-xtrabackup-备份" tabindex="-1"><a class="header-anchor" href="#_2-xtrabackup-备份" aria-hidden="true">#</a> 2. xtrabackup 备份</h2><h3 id="_2-1-备份脚本" tabindex="-1"><a class="header-anchor" href="#_2-1-备份脚本" aria-hidden="true">#</a> 2.1 备份脚本</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">BACKUP_DIR</span><span class="token operator">=</span>/home/dataexa/db-backup
<span class="token assign-left variable">DOCKER_BACKUP_DIR</span><span class="token operator">=</span>/var/lib/db-backup
<span class="token assign-left variable">MYSQL_USER</span><span class="token operator">=</span>root
<span class="token assign-left variable">MYSQL_PASS</span><span class="token operator">=</span>mypassword
<span class="token assign-left variable">MYSQL_HOST</span><span class="token operator">=</span><span class="token number">127.0</span>.0.1
<span class="token assign-left variable">MYSQL_PORT</span><span class="token operator">=</span><span class="token number">3306</span>
<span class="token assign-left variable">DATE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y-%m-%d_%H-%M-%S<span class="token variable">)</span></span>
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token variable">$BACKUP_DIR</span>/<span class="token variable">$DATE</span>
<span class="token function">chmod</span> <span class="token parameter variable">-R</span> <span class="token number">777</span> <span class="token variable">$BACKUP_DIR</span>/<span class="token variable">$DATE</span>
<span class="token function">sudo</span> <span class="token function">docker</span> stop percona-xtrabackup
<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token function">rm</span> percona-xtrabackup
<span class="token function">sudo</span> <span class="token function">docker</span> run   <span class="token parameter variable">--user</span> <span class="token number">0</span>:0 <span class="token parameter variable">--name</span> percona-xtrabackup --volumes-from mysql percona/percona-xtrabackup xtrabackup <span class="token parameter variable">--backup</span>  <span class="token parameter variable">--user</span><span class="token operator">=</span><span class="token variable">$MYSQL_USER</span> --target-dir<span class="token operator">=</span><span class="token variable">$DOCKER_BACKUP_DIR</span>/<span class="token variable">$DATE</span> <span class="token parameter variable">--user</span><span class="token operator">=</span><span class="token variable">$MYSQL_USER</span> <span class="token parameter variable">--password</span><span class="token operator">=</span><span class="token variable">$MYSQL_PASS</span> <span class="token parameter variable">--port</span><span class="token operator">=</span><span class="token variable">$MYSQL_PORT</span> <span class="token parameter variable">--host</span><span class="token operator">=</span><span class="token variable">$MYSQL_HOST</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意点：</p><ul><li>--user : 以root 角色运行容器，以免因为权限问题无法备份</li><li>--volumes-from：挂在到docker 的mysql 容器的相同数据卷、实现数据共享</li></ul><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章" aria-hidden="true">#</a> 参考文章</h2>`,10),d={href:"https://docs.percona.com/percona-xtrabackup/8.0/installation/docker.html",target:"_blank",rel:"noopener noreferrer"},k={href:"https://cn.openjianghu.org/doc/page/article/10080",target:"_blank",rel:"noopener noreferrer"};function b(u,v){const s=o("ExternalLinkIcon");return p(),l("div",null,[i,a("p",null,[a("a",d,[n("官方文档-xtrabackup-8.0文档"),e(s)])]),a("p",null,[a("a",k,[n("数据库备份之Xtrabackup"),e(s)])])])}const h=r(c,[["render",b],["__file","mysql-x-backup.html.vue"]]);export{h as default};
